!
logging buffered 128000
no logging console
logging facility local7
!
ip name-server vrf mgmt 1.1.1.1
ip name-server vrf mgmt 9.9.9.9
clock timezone UTC
!
ip multicast-routing
!
router pim sparse-mode
   ipv4
      rp address 10.0.0.0 233.84.178.0/24 override
!
vrf instance vrf1
ip routing
ip routing vrf vrf1
!
ntp server vrf mgmt 0.pool.ntp.org
ntp server vrf mgmt 1.pool.ntp.org
ntp server vrf mgmt 2.pool.ntp.org
!
no ip access-list MAIN-CONTROL-PLANE-ACL
ip access-list MAIN-CONTROL-PLANE-ACL
   counters per-entry
   10 permit icmp any any
   20 permit ip any any tracked
   30 permit udp any any eq bfd ttl eq 255
   40 permit udp any any eq bfd-echo ttl eq 254
   50 permit udp any any eq multihop-bfd micro-bfd sbfd
   60 permit udp any eq sbfd any eq sbfd-initiator
   70 permit ospf any any
   80 permit tcp any any eq ssh telnet www snmp bgp https msdp ldp netconf-ssh gnmi
   90 permit udp any any eq bootps bootpc snmp rip ntp ldp ptp-event ptp-general
   100 permit tcp any any eq mlag ttl eq 255
   110 permit udp any any eq mlag ttl eq 255
   120 permit vrrp any any
   130 permit ahp any any
   140 permit pim any any
   150 permit igmp any any
   160 permit tcp any any range 5900 5910
   170 permit tcp any any range 50000 50100
   180 permit udp any any range 51000 51100
   190 permit tcp any any eq 3333
   200 permit tcp any any eq nat ttl eq 255
   210 permit tcp any eq bgp any
   220 permit rsvp any any
   230 permit tcp any any eq 9340
   240 permit tcp any any eq 9559
   250 permit udp any any eq 8503
   260 permit udp any any eq lsp-ping
   270 permit udp any eq lsp-ping any
   280 remark Permit TWAMP (UDP 862)
   290 permit udp any any eq 862
!
system control-plane
   ip access-group MAIN-CONTROL-PLANE-ACL in
!
interface Ethernet2
   mtu 2048
   no switchport
   ip address 172.16.0.19/31
   pim ipv4 sparse-mode
   isis enable 1
   isis circuit-type level-2
   isis hello-interval 1
   isis hello padding
   isis network point-to-point
!
interface Loopback255
   ip address 172.16.0.1/32
   node-segment ipv4 index 1
   isis enable 1
!
interface Loopback256
   ip address 172.16.0.9/32
   isis enable 1
!
interface Vlan4001
   mtu 2048
   ip address 172.16.0.20/31
   pim ipv4 sparse-mode
   isis enable 1
   isis circuit-type level-2
   isis hello-interval 1
   isis hello padding
   isis network point-to-point
!
interface Loopback1000
   description RP Address
   ip address 10.0.0.0/32
!
mpls ip
!
mpls icmp ttl-exceeded tunneling
mpls icmp ip source-interface Loopback255
!
default interface Tunnel500
!
{{- range $i := seq 501 627}}
default interface Tunnel{{$i}}
!
{{- end}}
router bgp 65342
   router-id 172.16.0.1
   no neighbor 172.16.0.14
   neighbor 172.16.0.14 remote-as 65342
   neighbor 172.16.0.14 next-hop-self
   neighbor 172.16.0.14 update-source Loopback256
   neighbor 172.16.0.14 description ty2-dz01-ipv4
   neighbor 172.16.0.14 timers 3 9
   neighbor 172.16.0.14 send-community
   no neighbor 172.16.0.11
   neighbor 172.16.0.11 remote-as 65342
   neighbor 172.16.0.11 next-hop-self
   neighbor 172.16.0.11 update-source Loopback256
   neighbor 172.16.0.11 description ld4-dz01-ipv4
   neighbor 172.16.0.11 timers 3 9
   neighbor 172.16.0.11 send-community
   no neighbor 172.16.0.10
   neighbor 172.16.0.10 remote-as 65342
   neighbor 172.16.0.10 next-hop-self
   neighbor 172.16.0.10 update-source Loopback256
   neighbor 172.16.0.10 description la2-dz01-ipv4
   neighbor 172.16.0.10 timers 3 9
   neighbor 172.16.0.10 send-community
   no neighbor 172.16.0.13
   neighbor 172.16.0.13 remote-as 65342
   neighbor 172.16.0.13 next-hop-self
   neighbor 172.16.0.13 update-source Loopback256
   neighbor 172.16.0.13 description sg1-dz01-ipv4
   neighbor 172.16.0.13 timers 3 9
   neighbor 172.16.0.13 send-community
   no neighbor 172.16.0.16
   neighbor 172.16.0.16 remote-as 65342
   neighbor 172.16.0.16 next-hop-self
   neighbor 172.16.0.16 update-source Loopback256
   neighbor 172.16.0.16 description ams-dz001-ipv4
   neighbor 172.16.0.16 timers 3 9
   neighbor 172.16.0.16 send-community
   no neighbor 172.16.0.12
   neighbor 172.16.0.12 remote-as 65342
   neighbor 172.16.0.12 next-hop-self
   neighbor 172.16.0.12 update-source Loopback256
   neighbor 172.16.0.12 description frk-dz01-ipv4
   neighbor 172.16.0.12 timers 3 9
   neighbor 172.16.0.12 send-community
   no neighbor 172.16.0.15
   neighbor 172.16.0.15 remote-as 65342
   neighbor 172.16.0.15 next-hop-self
   neighbor 172.16.0.15 update-source Loopback256
   neighbor 172.16.0.15 description pit-dzd01-ipv4
   neighbor 172.16.0.15 timers 3 9
   neighbor 172.16.0.15 send-community
   no neighbor 172.16.0.6
   neighbor 172.16.0.6 remote-as 65342
   neighbor 172.16.0.6 next-hop-self
   neighbor 172.16.0.6 update-source Loopback255
   neighbor 172.16.0.6 description ty2-dz01-vpnv4
   neighbor 172.16.0.6 timers 3 9
   neighbor 172.16.0.6 send-community
   no neighbor 172.16.0.3
   neighbor 172.16.0.3 remote-as 65342
   neighbor 172.16.0.3 next-hop-self
   neighbor 172.16.0.3 update-source Loopback255
   neighbor 172.16.0.3 description ld4-dz01-vpnv4
   neighbor 172.16.0.3 timers 3 9
   neighbor 172.16.0.3 send-community
   no neighbor 172.16.0.2
   neighbor 172.16.0.2 remote-as 65342
   neighbor 172.16.0.2 next-hop-self
   neighbor 172.16.0.2 update-source Loopback255
   neighbor 172.16.0.2 description la2-dz01-vpnv4
   neighbor 172.16.0.2 timers 3 9
   neighbor 172.16.0.2 send-community
   no neighbor 172.16.0.5
   neighbor 172.16.0.5 remote-as 65342
   neighbor 172.16.0.5 next-hop-self
   neighbor 172.16.0.5 update-source Loopback255
   neighbor 172.16.0.5 description sg1-dz01-vpnv4
   neighbor 172.16.0.5 timers 3 9
   neighbor 172.16.0.5 send-community
   no neighbor 172.16.0.8
   neighbor 172.16.0.8 remote-as 65342
   neighbor 172.16.0.8 next-hop-self
   neighbor 172.16.0.8 update-source Loopback255
   neighbor 172.16.0.8 description ams-dz001-vpnv4
   neighbor 172.16.0.8 timers 3 9
   neighbor 172.16.0.8 send-community
   no neighbor 172.16.0.4
   neighbor 172.16.0.4 remote-as 65342
   neighbor 172.16.0.4 next-hop-self
   neighbor 172.16.0.4 update-source Loopback255
   neighbor 172.16.0.4 description frk-dz01-vpnv4
   neighbor 172.16.0.4 timers 3 9
   neighbor 172.16.0.4 send-community
   no neighbor 172.16.0.7
   neighbor 172.16.0.7 remote-as 65342
   neighbor 172.16.0.7 next-hop-self
   neighbor 172.16.0.7 update-source Loopback255
   neighbor 172.16.0.7 description pit-dzd01-vpnv4
   neighbor 172.16.0.7 timers 3 9
   neighbor 172.16.0.7 send-community
   address-family ipv4
      neighbor 172.16.0.14 activate
      neighbor 172.16.0.11 activate
      neighbor 172.16.0.10 activate
      neighbor 172.16.0.13 activate
      neighbor 172.16.0.16 activate
      neighbor 172.16.0.12 activate
      neighbor 172.16.0.15 activate
      no neighbor 172.16.0.6 activate
      no neighbor 172.16.0.3 activate
      no neighbor 172.16.0.2 activate
      no neighbor 172.16.0.5 activate
      no neighbor 172.16.0.8 activate
      no neighbor 172.16.0.4 activate
      no neighbor 172.16.0.7 activate
   !
   address-family vpn-ipv4
      neighbor 172.16.0.6 activate
      neighbor 172.16.0.3 activate
      neighbor 172.16.0.2 activate
      neighbor 172.16.0.5 activate
      neighbor 172.16.0.8 activate
      neighbor 172.16.0.4 activate
      neighbor 172.16.0.7 activate
   !
   vrf vrf1
      rd 65342:1
      route-target import vpn-ipv4 65342:1
      route-target export vpn-ipv4 65342:1
      router-id {{.DeviceIP}}
!
router isis 1
   net 49.0000.ac10.0001.0000.00
   router-id ipv4 172.16.0.1
   log-adjacency-changes
   !
   address-family ipv4 unicast
   !
   segment-routing mpls
      no shutdown
!
ip community-list COMM-ALL_USERS permit 21682:1200
ip community-list COMM-ALL_MCAST_USERS permit 21682:1300
!
no route-map RM-USER-500-OUT
!
{{- range $i := seq 501 627}}
no route-map RM-USER-{{$i}}-OUT
!
{{- end}}
no route-map RM-USER-500-IN
!
{{- range $i := seq 501 627}}
no route-map RM-USER-{{$i}}-IN
!
{{- end}}
no ip prefix-list PL-USER-500
!
{{- range $i := seq 501 627}}
no ip prefix-list PL-USER-{{$i}}
!
{{- end}}
{{- range $i := seq 500 627}}
no ip access-list SEC-USER-{{$i}}-IN
{{- end}}
{{- range $i := seq 500 627}}
no ip access-list standard SEC-USER-MCAST-BOUNDARY-{{$i}}-OUT
{{- end}}
no ip access-list SEC-USER-PUB-MCAST-IN
ip access-list SEC-USER-PUB-MCAST-IN
   counters per-entry
   permit icmp any any
   permit tcp any any eq bgp
   permit ip any 224.0.0.13/32
   permit ip any 233.84.178.0/24
   deny ip any any
!
no ip access-list SEC-USER-SUB-MCAST-IN
ip access-list SEC-USER-SUB-MCAST-IN
   counters per-entry
   permit icmp any any
   permit tcp any any eq bgp
   permit ip any 224.0.0.13/32
   deny ip any any
!
no router msdp
router msdp
   peer 172.16.0.14
      mesh-group DZ-1
      local-interface Loopback256
      description ty2-dz01
   peer 172.16.0.11
      mesh-group DZ-1
      local-interface Loopback256
      description ld4-dz01
   peer 172.16.0.10
      mesh-group DZ-1
      local-interface Loopback256
      description la2-dz01
   peer 172.16.0.13
      mesh-group DZ-1
      local-interface Loopback256
      description sg1-dz01
   peer 172.16.0.16
      mesh-group DZ-1
      local-interface Loopback256
      description ams-dz001
   peer 172.16.0.12
      mesh-group DZ-1
      local-interface Loopback256
      description frk-dz01
   peer 172.16.0.15
      mesh-group DZ-1
      local-interface Loopback256
      description pit-dzd01
